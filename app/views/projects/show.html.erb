<div class="row">
  <div class="col-md-8">
    <!-- Project Details Card -->
    <div class="card">
      <div class="card-header">
        <h4 class="card-title mb-0">
          <i class="bi bi-folder me-2"></i>
          <%= @project.name %>
        </h4>
      </div>
      <div class="card-body">
        <div class="row mb-3">
          <div class="col-sm-3">
            <strong>Description:</strong>
          </div>
          <div class="col-sm-9">
            <%= @project.desc.presence || '<span class="text-muted">No description</span>'.html_safe %>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-sm-3">
            <strong>Manager:</strong>
          </div>
          <div class="col-sm-9">
            <span class="badge bg-primary">
              <i class="bi bi-person-gear me-1"></i>
              <%= @project.manager.name %>
            </span>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-sm-3">
            <strong>Created:</strong>
          </div>
          <div class="col-sm-9">
            <%= @project.created_at.strftime("%B %d, %Y") %>
          </div>
        </div>

        <div class="row">
          <div class="col-sm-3">
            <strong>Team Size:</strong>
          </div>
          <div class="col-sm-9">
            <%= @project.users.count %> members
          </div>
        </div>
      </div>
    </div>

    <!-- Tickets Summary Card -->
    <div class="card mt-4">
      <div class="card-header">
        <h5 class="card-title mb-0">
          <i class="bi bi-ticket-perforated me-2"></i>
          Tickets Summary
        </h5>
      </div>
      <div class="card-body">
        <div class="row text-center">
          <div class="col-md-3">
            <div class="border rounded p-3">
              <h4 class="text-primary"><%= @project.tickets.count %></h4>
              <small class="text-muted">Total Tickets</small>
            </div>
          </div>
          <div class="col-md-3">
            <div class="border rounded p-3">
              <h4 class="text-warning"><%= @project.tickets.bugs.count %></h4>
              <small class="text-muted">Bugs</small>
            </div>
          </div>
          <div class="col-md-3">
            <div class="border rounded p-3">
              <h4 class="text-info"><%= @project.tickets.features.count %></h4>
              <small class="text-muted">Features</small>
            </div>
          </div>
          <div class="col-md-3">
            <div class="border rounded p-3">
              <h4 class="text-success"><%= @project.tickets.where(status: ['completed', 'resolved']).count %></h4>
              <small class="text-muted">Resolved</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <!-- Team Members Card -->
    <div class="card">
      <div class="card-header">
        <h5 class="card-title mb-0">
          <i class="bi bi-people me-2"></i>
          Team Members
        </h5>
      </div>
      <div class="card-body">
        <!-- Manager -->
        <div class="d-flex justify-content-between align-items-center mb-3 p-2 bg-light rounded">
          <div>
            <strong><%= @project.manager.name %></strong>
            <span class="badge bg-primary ms-2">Manager</span>
          </div>
        </div>

        <!-- Developers -->
        <% if @project.developers.any? %>
          <h6 class="text-muted mb-2">Developers (<%= @project.developers.count %>)</h6>
          <% @project.developers.each do |developer| %>
            <div class="d-flex justify-content-between align-items-center mb-2 p-2 border rounded">
              <div>
                <%= developer.name %>
                <small class="text-muted d-block"><%= developer.email %></small>
              </div>
              <!-- REMOVED: Remove button from show page -->
            </div>
          <% end %>
        <% else %>
          <p class="text-muted">No developers assigned</p>
        <% end %>

        <!-- QA Testers -->
        <% if @project.qas.any? %>
          <h6 class="text-muted mb-2 mt-3">QA Testers (<%= @project.qas.count %>)</h6>
          <% @project.qas.each do |qa| %>
            <div class="d-flex justify-content-between align-items-center mb-2 p-2 border rounded">
              <div>
                <%= qa.name %>
                <small class="text-muted d-block"><%= qa.email %></small>
              </div>
              <!-- REMOVED: Remove button from show page -->
            </div>
          <% end %>
        <% else %>
          <p class="text-muted">No QA testers assigned</p>
        <% end %>
      </div>
    </div>

    <!-- REMOVED: Entire "Add Users Card" from show page -->
  </div>
</div>

<!-- Action Buttons -->
<div class="mt-4">
  <% if policy(@project).edit? %>
    <%= link_to edit_project_path(@project), class: "btn btn-warning" do %>
      <i class="bi bi-pencil me-1"></i>Edit Project & Team
    <% end %>
  <% end %>
  
  <%= link_to projects_path, class: "btn btn-secondary" do %>
    <i class="bi bi-arrow-left me-1"></i>Back to Projects
  <% end %>

  <% if policy(@project).destroy? %>
    <%= button_to @project, method: :delete, 
                class: "btn btn-danger float-end",
                form: { data: { turbo_confirm: "Are you sure you want to delete this project and all its tickets?" } } do %>
      <i class="bi bi-trash me-1"></i>Delete Project
    <% end %>
  <% end %>
</div>